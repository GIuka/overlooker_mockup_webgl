<!DOCTYPE html>
<html lang="">

<head>
  <title>Overlooker</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <meta charset="utf-8">
  <script src="libraries/twgl.min.js"></script>
</head>

<body>
  <canvas id="cgl">
    <script id="vs" type="notjs">
  precision mediump float;

  attribute vec4 a_position;
  attribute vec2 a_texcoord;

  varying vec2 v_texCoord;
  
  void main() {
    v_texCoord = a_texcoord;
    gl_Position = a_position;
  }
      </script>
    <script id="fs" type="notjs">
  precision mediump float;
  
  uniform vec2 u_resolution;
  uniform vec2 u_mouse;
  uniform float u_time;
  uniform vec3 u_gridparams;
  uniform vec4 u_colortheme[6];
  uniform sampler2D u_texture;

  varying vec2 v_texCoord;
  float aa_factor = u_gridparams.y * 1.5 / u_resolution.y;

  float circle_dist(in vec2 _uv) { 
    float d = length(_uv.xy * 2.0 - vec2(1.0));
    float t = 1.0 - smoothstep(0.5 + aa_factor, 0.5 - aa_factor, d * 0.51);
    return 1.0 - t;
  }

  float circle_dot(in vec2 _uv) {
    vec2 centered = _uv.xy * vec2(2.0) - vec2(1.0);
    float d = 0.5 * dot(centered, centered);
    return smoothstep(0.5 + aa_factor, 0.5 - aa_factor, d);
  }

  // TODO: move to a texture shader to minimize branching penalty.
  vec4 colorCheck(in float _code) {
    vec4 _color = vec4(0.0);
    if (_code <= 0.0) {
      if (u_colortheme[5].x + u_colortheme[5].y + u_colortheme[5].z < 1.0) {
        _color = u_colortheme[0] + vec4(0.2, 0.2, 0.2, 0.0); // Uninit
      } else {
        _color = u_colortheme[0] - vec4(0.2, 0.2, 0.2, 0.0); // Uninit
      }
    } else if (_code <= 0.2) {
      _color = u_colortheme[1]; // OnCall
    } else if (_code <= 0.4) {
      _color = u_colortheme[2]; // Available
    } else if (_code <= 0.6) {
      _color = u_colortheme[3]; // PreviewingTask
    } else if (_code <= 0.8) {
      _color = u_colortheme[4]; // AfterCall
    } else {
      _color = u_colortheme[5]; // LoggedOut
    }
    return _color;
  }

  void main() {
    vec4 tex_color = texture2D(u_texture, v_texCoord);
    vec2 uv = v_texCoord.xy;
    vec4 start_color = colorCheck(tex_color.x);
    vec4 end_color = colorCheck(tex_color.y);
    vec4 shaded = mix(start_color, end_color, tex_color.w);
    
    // Split screen into divisions.
    uv.xy = fract(u_gridparams.xy * uv.xy);

    gl_FragColor = mix(u_colortheme[5], shaded, circle_dot(uv));
  }
      </script>
  </canvas>
</body>
<script src="call_center_mockup.js"></script>

</html>
